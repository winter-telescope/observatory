# Notes on GIT Best Pracitces

## Branches and Merging
As the code gets more complex, we should try to implement a more rigorous workflow to avoid bad merges, overwriting changes, and staging bad/buggy code in the `main` branch. This is the general approach to follow:
1. **Create a New Feature Branch** For example, to create (and enter) a new branch that is derived from `main` (eg starts out as a copy of `main`) and is called `featurebranch`, do this: `git checkout -b featurebranch main`. Then make sure you are in the correct branch by checking this way: `git branch`. To switch back to a different branch, just check it out: `git checkout branchname`. Some notes:
     - Make the branch name easy to remember/type, and has something to do with what you're working on. Some operating systems will not autocomplete and it's a pain to get them right if you want to check them out). Good examples: `domesim`, `focusing`, `chillerBug`. Bad examples: `Nates_Branch_That_Attempts_to_Fix_A_Bug_in_the_Calibration_Code`, `natebranch`, `test_v2`.
3. **Do Your Work in the New Branch** Some notes (generally true, though perhaps some exceptions):
     - It is *not a good idea to work in somebody else's branch!* Doing so can cause that person a lot of grief. 
     - DO NOT WORK IN THE MAIN BRANCH. Doing so results in intermediate/untested code in the main branch. This makes it hard to get back to a working state, and we ALWAYS want the main branch to be functional, even if there are bugs that you are trying to fix in other branches.
     - **COMMIT AND PUSH CHANGES OFTEN** It's easy to get way down the road of something and then realize you've fixed and then unfixed something. This is hard to fix if you have no log of the changes. Some good rules of thumb are to push at minimum every time you stop for the day, and every time you switch computers (to avoid conflicts). We all mess this up. But it's good to try to remember. Also be sure to put useful commit comments when you do commits so that you can plausably retrace your steps if you need. The easy way to do this is: `git commit -m "this is a comment about the changes I made to today, some of which were good, and some of which may prove to be evil" `
4. **Issue a Pull Request through the github Website** when you are ready to merge your branch. This is the best way to avoid messy merges, visualize which branch is going to be merged into which other branch, track who/why/when/how the merge occured, write notes for what is happening, and request that somebody else review the request/assign them to complete the "pull." NOTE: this is a different mechanism than in gitlab. In github you ask that a branch be "pulled" into another branch (eg merge feature into main by "pulling" it into main). In gitlab you open a "merge request" where you specify a source (eg feature branch) and a target branch (eg main). Here's how to do it:
      1. go to the winter-telescope/observatory page, and navigate to the feature branch page. This should be something like `github.com/winter-telescope/observatory/tree/FEATURE_BRANCH_NAME`. 
      2. Towards the top of the page, there is a box that should say something like "This branch is 3 commits ahead of main", with a little dropdown button that says "Contribute". Click this button. You can select `Compare` to view the differences between selected branches. Once you are happy, `Create pull request` or `Open pull request`.
      3. Write up a nice comment in the pull request box describing the changes, a nice name (eg "improved startup procedure"), and assign the merge to somebody to complete. For WSP, please assign (or at the very least notify!) Nate about any merges into main. For merges within your own feature branches, feel free to assign yourself.
5. **TEST OUT THE BRANCH YOU MERGED INTO** did you mess it up? That would be sad. Just make sure you didn't! 
6. **Delete branches that will never be used again** this one is hard because sometimes you want to keep it around in case you have to go back. I don't have a great idea here, but probably we should do periodic purges and notify everybody that it's happening and solicit requests for any branches that you wish to be spared deletion. 

